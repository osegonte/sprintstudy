# ==============================================
# SUPABASE CONFIGURATION (REQUIRED)
# ==============================================
# Get these from your Supabase project settings

# Your Supabase project URL
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_KEY=your-service-role-key-here

# ==============================================
# SERVER CONFIGURATION
# ==============================================

# Port for the API server
PORT=3000

# Environment (development, staging, production)
NODE_ENV=development

# ==============================================
# FRONTEND INTEGRATION (CUSTOM FRONTEND)
# ==============================================

# Your custom frontend URL (update with your actual frontend URL)
FRONTEND_URL=http://localhost:5173

# Additional allowed origins for CORS (comma-separated)
ADDITIONAL_CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8080,http://localhost:4173

# ==============================================
# CORS CONFIGURATION
# ==============================================

CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Custom frontend integration (set to false if not using Lovable)
LOVABLE_INTEGRATION_ENABLED=false
LOVABLE_CORS_ENABLED=false
LOVABLE_REALTIME_ENABLED=false

# ==============================================
# OPTIONAL CONFIGURATION
# ==============================================

# File upload limits
MAX_FILE_SIZE_MB=50
MAX_FILES_PER_UPLOAD=1

# Rate limiting configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=200

# PDF processing configuration
PDF_PROCESSING_TIMEOUT_MS=30000
ENABLE_PDF_ANALYSIS=true

# Analytics configuration
ENABLE_REAL_TIME_ANALYTICS=true
ANALYTICS_RETENTION_DAYS=365

# ==============================================
# DEPLOYMENT CONFIGURATION
# ==============================================

# Database connection timeout
DB_TIMEOUT_MS=10000

# API response timeout
API_TIMEOUT_MS=30000

# Enable detailed logging (true/false)
ENABLE_VERBOSE_LOGGING=false

# Enable performance monitoring
ENABLE_PERFORMANCE_MONITORING=true

# ==============================================
# THIRD-PARTY INTEGRATIONS (OPTIONAL)
# ==============================================

# Email service configuration (for notifications)
# EMAIL_PROVIDER=sendgrid
# SENDGRID_API_KEY=your-sendgrid-api-key
# FROM_EMAIL=noreply@yourdomain.com

# AI/ML service configuration (for enhanced PDF analysis)
# OPENAI_API_KEY=your-openai-api-key
# ANTHROPIC_API_KEY=your-anthropic-api-key

# Monitoring and error tracking
# SENTRY_DSN=your-sentry-dsn
# DATADOG_API_KEY=your-datadog-api-key

# ==============================================
# SECURITY CONFIGURATION
# ==============================================

# Security headers
HELMET_ENABLED=true
CSP_ENABLED=true

# Session configuration
SESSION_TIMEOUT_HOURS=24
REFRESH_TOKEN_EXPIRY_DAYS=30

# ==============================================
# DEVELOPMENT TOOLS
# ==============================================

# Enable API documentation endpoint
ENABLE_API_DOCS=true

# Enable debug endpoints
ENABLE_DEBUG_ENDPOINTS=true

# Enable request logging
ENABLE_REQUEST_LOGGING=true

# Enable performance profiling
ENABLE_PROFILING=false

# ==============================================
# SETUP INSTRUCTIONS
# ==============================================

# 1. Copy this file to .env: cp .env.example .env
# 2. Update the SUPABASE_* values with your actual Supabase credentials
# 3. Update FRONTEND_URL with your actual frontend URL
# 4. Run the database migration in Supabase SQL Editor
# 5. Start the server: npm run dev
# 6. Test the integration at http://localhost:3000/health

# ==============================================
# GETTING SUPABASE CREDENTIALS
# ==============================================

# 1. Go to https://supabase.com/dashboard
# 2. Select your project (or create a new one)
# 3. Go to Settings > API
# 4. Copy:
#    - Project URL → SUPABASE_URL
#    - Project API Keys:
#      - anon/public → SUPABASE_ANON_KEY
#      - service_role → SUPABASE_SERVICE_KEY

# ==============================================
# SECURITY NOTES
# ==============================================

# - Never commit .env files to version control
# - Keep SUPABASE_SERVICE_KEY secret and secure
# - Use different credentials for development/staging/production
# - Regularly rotate API keys and secrets
# - Monitor access logs for unusual activity

# ==============================================
# TROUBLESHOOTING
# ==============================================

# Common issues and solutions:

# Database connection errors:
# - Verify SUPABASE_URL and keys are correct
# - Check that your Supabase project is active
# - Ensure database migration has been run

# CORS errors:
# - Ensure FRONTEND_URL matches your frontend URL exactly
# - Add your frontend URL to ADDITIONAL_CORS_ORIGINS
# - Check that your frontend is running on the specified port

# File upload errors:
# - Check that Supabase storage bucket 'pdf-documents' exists
# - Verify storage policies are correctly configured
# - Ensure MAX_FILE_SIZE_MB is appropriate

# Authentication errors:
# - Verify Supabase Auth is enabled in your project
# - Check that RLS policies are correctly configured
# - Ensure JWT tokens are being passed correctly from frontend

# ==============================================
# API ENDPOINTS FOR YOUR FRONTEND
# ==============================================

# Base URL: http://localhost:3000/api

# Authentication:
# POST /api/auth/signup - User registration
# POST /api/auth/login - User login
# GET /api/auth/me - Get current user

# Enhanced Time Tracking:
# GET /api/dashboard-enhanced/time-summary - Comprehensive time summary
# GET /api/dashboard-enhanced/time-by-topic - Time breakdown by topic
# POST /api/page-tracking/start-page/:doc_id/:page_num - Start page timer
# POST /api/page-tracking/complete-page/:doc_id/:page_num - Complete page
# GET /api/page-tracking/estimates/all - All document time estimates

# Documents & Topics:
# GET /api/documents - Get user documents
# POST /api/documents/upload - Upload PDF
# GET /api/topics - Get topics
# POST /api/topics - Create topic

# Analytics:
# GET /api/analytics/dashboard - Basic dashboard
# GET /api/analytics/trends - Performance trends